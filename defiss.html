<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw8klWQQTfcMRyvbLJD2i80lznpdF44EA38Ust_wQJG-Wx-474HXYcs1zh0deULjgSX0g/exec"; // colle l’URL ici

async function chargerDefis(niveau) {
  let res = await fetch(API_URL);
  let data = await res.json();
  return data.filter(d => d.niveau == niveau);
}

async function nouveauDefi() {
  const niveau = document.getElementById("niveau").value;
  let defis = await chargerDefis(niveau);

  if (defis.length === 0) {
    document.getElementById("defi").textContent = "Aucun défi pour ce niveau.";
    return;
  }

  const index = Math.floor(Math.random() * defis.length);
  document.getElementById("defi").textContent = defis[index].texte;
}

async function ajouterDefi() {
  const texte = document.getElementById("nouveau").value.trim();
  const niveau = document.getElementById("niveauAjout").value;

  if (!texte) {
    alert("Écris un défi avant d’ajouter !");
    return;
  }

  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ texte: texte, niveau: niveau })
  });

  alert("Défi ajouté avec succès !");
  document.getElementById("nouveau").value = "";
}
</script>